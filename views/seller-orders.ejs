<%- include('partials/header') %>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h2>Customer Orders</h2>
  <a href="/seller/homepage" class="btn btn-outline-primary">Back to Dashboard</a>
</div>

<div class="card shadow mb-4">
  <div class="card-header bg-primary text-white">
    <h4 class="mb-0">Order History</h4>
  </div>
  <div class="card-body">
    <% if (orders && orders.length > 0) { %>
      <div class="table-responsive">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Order ID</th>
              <th>Customer</th>
              <th>Product</th>
              <th>Quantity</th>
              <th>Unit Price</th>
              <th>Total</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody>
            <% orders.forEach(order => { %>
              <tr>
                <td><%= order.oid %></td>
                <td>
                  <%= order.customer ? `${order.customer.fname} ${order.customer.lname}` : 'Unknown' %>
                </td>
                <td>
                  <%= order.product ? order.product.pname : 'Unknown' %>
                </td>
                <td><%= order.quantity %></td>
                <td>$<%= order.product ? order.product.price.toFixed(2) : 'N/A' %></td> <!-- Price formatted -->
                <td>$<%= order.product ? (order.quantity * order.product.price).toFixed(2) : 'N/A' %></td> <!-- Total formatted -->
                <td><%= new Date(order.timestamp).toLocaleDateString() %></td> <!-- Simplified Date Format -->
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    <% } else { %>
      <div class="alert alert-info text-center">
        <h4>No orders found.</h4>
        <p>You haven't received any customer orders yet.</p>
      </div>
    <% } %>
  </div>
</div>

<%- include('partials/footer') %>
